# API 一覧・設計 (Roles 別 + 認証周り含む)

> **前提**
> - **Next.js**(TypeScript) をベースに **ビジネスロジックを分離**。
> - **ロール**は「**admin**(管理者)」「**user**(一般ユーザー)」に加え、「**guest**(未ログイン)」状態も考慮。
> - **認証**は以下をサポート:
>   1. **Googleアカウント認証** (OAuth 2.0)
>   2. **JWT** (自前ログイン用; email+pwなど)
> - ログインまわり (サインアップ/サインイン/パスワードリセット/Googleログイン) をすべて網羅。
> - **Vercelの**`/api`**ルート**でロールごとに `/api/admin/...` と `/api/user/...`、さらに認証系は `/api/auth/...` として整理。
> - **すべての機能**に対して、必要がありそうな**APIを漏れなく**定義。
> - **リクエストとレスポンス**は TypeScript 型を示し、**例**のJSONをつける。
> - **エラー**についても共通フォーマットを示す。

## ドキュメント構成

このAPIドキュメントは以下のように構成されています：

1. [共通仕様](./common/README.md) - ディレクトリ構成、認証・認可概要、共通仕様
2. [認証系API](./auth/README.md) - ユーザー登録、ログイン、ログアウト、パスワード管理
3. [ユーザーロールAPI](./user/README.md) - 一般ユーザーが利用する機能
4. [管理者ロールAPI](./admin/README.md) - 管理者のみが操作する機能

## API概要

### 認証系 ( `/api/auth/...` )

認証関連のエンドポイントを提供します。ユーザー登録、ログイン、ログアウト、パスワード管理などの機能を含みます。

| 主要エンドポイント | 説明 |
|-----------------|------|
| `/api/auth/register` | ユーザー登録 |
| `/api/auth/login` | メール&パスワードログイン |
| `/api/auth/google-callback` | Google OAuth ログイン |
| `/api/auth/logout` | ログアウト |

### ユーザーロール ( `/api/user/...` )

一般ユーザーが利用する機能のエンドポイントを提供します。コンテンツの閲覧、タグ管理、システム状態確認などの機能を含みます。

| 主要エンドポイント | 説明 |
|-----------------|------|
| `/api/user/contents` | コンテンツ一覧取得 |
| `/api/user/contents/[id]` | コンテンツ詳細取得 |
| `/api/user/tags` | タグ一覧取得 |

### 管理者ロール ( `/api/admin/...` )

管理者が利用する機能のエンドポイントを提供します。ソース管理、コンテンツ管理、AIモデル管理、通知履歴管理、タグ管理、システム設定管理などの機能を含みます。

| 主要カテゴリ | 説明 |
|------------|------|
| `/api/admin/sources/...` | ソース管理 |
| `/api/admin/contents/...` | コンテンツ管理 |
| `/api/admin/ai-models/...` | AIモデル管理 |
| `/api/admin/notifications/...` | 通知履歴管理 |
| `/api/admin/tags/...` | タグ管理 |
| `/api/admin/system/...` | システム設定管理 |