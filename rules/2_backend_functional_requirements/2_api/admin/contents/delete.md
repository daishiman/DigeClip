# コンテンツ削除 API

- **HTTPメソッド**: `DELETE`
- **エンドポイント**: `/api/admin/contents/[id]`
- **機能概要**: 特定のコンテンツを削除
- **認証要否**: **要**(admin)

## リクエスト

**Request**: パスパラメータとして `id` を含む

## レスポンス

**Response**: `IAdminDeleteContentResponse`
```ts
export interface IAdminDeleteContentResponse {
  message: string;
  id: number;
}
```

**例 (レスポンスJSON)**
```jsonc
{
  "message": "Content deleted successfully",
  "id": 42
}
```

## エラー

**Error**: e.g. `404 Not Found` (コンテンツが見つからない)
```jsonc
{
  "error": {
    "code": "E4042",
    "message": "Content not found"
  }
}
```

## 実装上の注意事項

1. **認証・認可**:
   - 管理者権限を持つユーザーのみアクセス可能なエンドポイントです。
   - リクエスト処理前に必ず認証トークンを検証し、管理者権限を確認してください。

2. **パスパラメータの検証**:
   - `id` パラメータは数値であることを確認してください。
   - 不正な形式の場合は `400 Bad Request` を返してください。

3. **トランザクション処理**:
   - 削除操作は必ずトランザクション内で実行してください。
   - 関連するデータ（summaries, notifications, tags関連など）も適切に削除または更新する必要があります。
   - 参照整合性を維持するため、外部キー制約を考慮してください。

4. **ソフトデリート**:
   - 実際のデータを物理的に削除するのではなく、`deleted_at` フラグを設定するソフトデリートを実装することを推奨します。
   - これにより、誤削除からの復旧やデータ分析の整合性を維持できます。

5. **エラーハンドリング**:
   - コンテンツが存在しない場合は `404 Not Found` を返してください。
   - 削除中にエラーが発生した場合は、トランザクションをロールバックし、`500 Internal Server Error` を返してください。
   - 詳細なエラーログを記録してください。

6. **監査ログ**:
   - 誰がいつどのコンテンツを削除したかを記録する監査ログを実装してください。
   - ログには少なくとも、操作者ID、操作日時、対象コンテンツID、操作種別を含めてください。

7. **同時実行制御**:
   - 同じコンテンツに対する同時削除リクエストを適切に処理するため、楽観的ロックまたは悲観的ロックを検討してください。

8. **キャッシュ管理**:
   - 削除後、関連するキャッシュを適切に無効化してください。
   - 特に、コンテンツリスト、タグ関連のキャッシュなどが影響を受ける可能性があります。

9. **関連リソースの処理**:
   - コンテンツに関連する添付ファイルやメディアがある場合、それらのストレージリソースも適切に処理（削除または保持）してください。